"use strict";(self.webpackChunkAppointent_App=self.webpackChunkAppointent_App||[]).push([[725],{5725:(R,x,p)=>{p.r(x),p.d(x,{AppointmentsTimetableModule:()=>J});var m=p(6895),u=p(2019);function w(i,s,n,t,o,a,l){try{var r=i[a](l),c=r.value}catch(d){return void n(d)}r.done?s(c):Promise.resolve(c).then(t,o)}function g(i){return function(){var s=this,n=arguments;return new Promise(function(t,o){var a=i.apply(s,n);function l(c){w(a,t,o,l,r,"next",c)}function r(c){w(a,t,o,l,r,"throw",c)}l(void 0)})}}class h{constructor(s){this.isEmpty=s,this.TimeSlots=[]}}class C{constructor(s,n){this.weekStartIndex=s,this.weekEndIndex=n}}var A=p(7818),e=p(8256),k=p(2646),_=p(7303),S=p(5973);function W(i,s){if(1&i){const n=e.EpF();e.TgZ(0,"div",3),e.NdJ("click",function(){e.CHM(n);const o=e.oxw().$implicit,a=e.oxw();return e.KtG(a.BookAppointment(o))}),e.TgZ(1,"span"),e._uU(2,"Open"),e.qZA()()}if(2&i){const n=e.oxw().$implicit;e.Akn(n.StylingSlotHeight)}}function O(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1,"Pending"),e.qZA())}function I(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,O,2,0,"span",5),e.qZA()),2&i){const n=e.oxw(2).$implicit;e.xp6(1),e.hij("",null==n.CurrentAppointment?null:n.CurrentAppointment.AppointmentName," "),e.xp6(1),e.Q6J("ngIf",0==(null==n.CurrentAppointment?null:n.CurrentAppointment.isConfirmed))}}function N(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1,"Booked"),e.qZA())}function M(i,s){if(1&i){const n=e.EpF();e.TgZ(0,"div",4),e.NdJ("click",function(){e.CHM(n);const o=e.oxw().$implicit,a=e.oxw();return e.KtG(a.EditAppointment(o))}),e.YNc(1,I,3,2,"span",5),e.YNc(2,N,2,0,"span",5),e.qZA()}if(2&i){const n=e.oxw().$implicit,t=e.oxw();e.Akn(n.StylingSlotHeight),e.xp6(1),e.Q6J("ngIf",t.auth.loggedIn()),e.xp6(1),e.Q6J("ngIf",!t.auth.loggedIn())}}function Z(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,W,3,2,"div",1),e.YNc(2,M,3,4,"div",2),e.qZA()),2&i){const n=s.$implicit;e.xp6(1),e.Q6J("ngIf",n.isBlank),e.xp6(1),e.Q6J("ngIf",!n.isBlank)}}let D=(()=>{class i{constructor(n,t,o){this.router=n,this.apmnt=t,this.auth=o,this.WeekDays=[],this.CurrentWeekIndex=0,this.isDailyViewMode=!0,this.Timeslots=[],this.AppointmentToReSchedule=new S.u(0,"","","","","","","",0,"",0,0,0)}ngOnInit(){this.Timeslots=this.WeekDays[this.CurrentWeekIndex].TimeSlots,this.apmnt.OnUpdateViewIndex.subscribe(n=>{this.isDailyViewMode&&(this.CurrentWeekIndex=n),this.Timeslots=this.WeekDays[this.CurrentWeekIndex].TimeSlots})}BookAppointment(n){if(this.apmnt.isRescheduling)return this.AppointmentToReSchedule=this.apmnt.AppointmentToReSchedule,this.apmnt.ValidSlotLength(n,this.AppointmentToReSchedule.AppointmentDurationInMinutes)?(this.AppointmentToReSchedule.AppointmentTime=n.StartTime,this.AppointmentToReSchedule.AppointmentDate=n.dateOfSlot,n.CurrentAppointment=this.AppointmentToReSchedule,this.apmnt.RecieveAppointment(n),this.apmnt.OnAppointmentSelected.next(!0),void this.router.navigate(["/AppointmentInfo"])):void console.log("invalid timeslot for appointment");this.auth.loggedIn()||(this.apmnt.OnBlankSlotSelected.next(!0),this.apmnt.RecieveAppointment(n),this.router.navigate(["/AppointmentForm"]))}EditAppointment(n){this.auth.loggedIn()&&(this.apmnt.isRescheduling||(this.apmnt.OnAppointmentSelected.next(!0),this.apmnt.RecieveAppointment(n),this.router.navigate(["/AppointmentInfo"])))}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(u.F0),e.Y36(k.H),e.Y36(_.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-timeslots-for-day"]],inputs:{WeekDays:"WeekDays",CurrentWeekIndex:"CurrentWeekIndex",isDailyViewMode:"isDailyViewMode"},standalone:!0,features:[e.jDz],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["class","Appointment-blank",3,"style","click",4,"ngIf"],["class","Appointment-filled",3,"style","click",4,"ngIf"],[1,"Appointment-blank",3,"click"],[1,"Appointment-filled",3,"click"],[4,"ngIf"]],template:function(n,t){1&n&&e.YNc(0,Z,3,2,"div",0),2&n&&e.Q6J("ngForOf",t.Timeslots)},dependencies:[m.ez,m.sg,m.O5,u.Bz],styles:[".Appointment-blank[_ngcontent-%COMP%]{background-color:#b4b4b44d;color:#fff;text-shadow:-1px -1px 0 black,1px -1px 0 black,-1px 1px 0 black,1px 1px 0 black;text-align:center;font-weight:700;font-size:clamp(3vw,5vw + 1rem);display:flex;align-items:center;justify-content:center;border-left:2px solid black;border-right:2px solid black}.Appointment-blank[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{transform:rotate(-45deg);display:inline-block}.Appointment-blank[_ngcontent-%COMP%]:hover{background-color:#60b2f5}.Appointment-filled[_ngcontent-%COMP%]{border-left:2px solid black;border-right:2px solid black;display:flex;align-items:center;justify-content:center;text-align:center;font-weight:700;font-size:clamp(1.2rem,5vw + 1rem)}"]}),i})();function F(i,s){if(1&i&&(e.TgZ(0,"div")(1,"div",10)(2,"div",6)(3,"span"),e._uU(4),e.ALo(5,"date"),e.qZA(),e._UZ(6,"br"),e.TgZ(7,"span"),e._uU(8),e.ALo(9,"date"),e.qZA()(),e._UZ(10,"app-timeslots-for-day",11),e.qZA()()),2&i){const n=e.oxw(2);e.xp6(2),e.Akn(n.HeaderWidthStyle),e.xp6(2),e.Oqu(e.xi3(5,7,n.CurrentWeekDates[n.DayViewIndex],"EEEE")),e.xp6(4),e.Oqu(e.xi3(9,10,n.CurrentWeekDates[n.DayViewIndex],"d MMMM")),e.xp6(2),e.Q6J("WeekDays",n.WeekDays)("CurrentWeekIndex",n.DayViewIndex)("isDailyViewMode",!0)}}function V(i,s){if(1&i&&(e.TgZ(0,"div")(1,"div",6)(2,"span"),e._uU(3),e.ALo(4,"date"),e.qZA(),e._UZ(5,"br"),e.TgZ(6,"span"),e._uU(7),e.ALo(8,"date"),e.qZA()(),e._UZ(9,"app-timeslots-for-day",11),e.qZA()),2&i){const n=e.oxw().index,t=e.oxw(2);e.xp6(1),e.Akn(t.HeaderWidthStyle),e.xp6(2),e.Oqu(e.xi3(4,7,t.CurrentWeekDates[n],"EEEE")),e.xp6(4),e.Oqu(e.xi3(8,10,t.CurrentWeekDates[n],"d MMMM")),e.xp6(2),e.Q6J("WeekDays",t.WeekDays)("CurrentWeekIndex",n)("isDailyViewMode",!1)}}function U(i,s){if(1&i&&(e.TgZ(0,"div",10),e.YNc(1,V,10,13,"div",4),e.qZA()),2&i){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!n.ShowDaliyOnly)}}function H(i,s){if(1&i&&(e.TgZ(0,"div",12)(1,"span"),e._uU(2),e.ALo(3,"date"),e.qZA(),e._UZ(4,"br"),e.qZA()),2&i){const n=s.$implicit,t=e.oxw(2);e.Akn(t.TimeslotWidthStyle),e.xp6(1),e.Akn(t.TimeslotSeperatorStyle),e.xp6(1),e.Oqu(e.xi3(3,5,t.StartOfWorkday.getTime()+60*n*60*1e3,"HH:mm"))}}function P(i,s){if(1&i&&(e.TgZ(0,"div")(1,"div",5)(2,"div",6)(3,"span"),e._uU(4,"Available"),e.qZA(),e._UZ(5,"br"),e.TgZ(6,"span"),e._uU(7,"Times"),e.qZA()(),e.YNc(8,F,11,13,"div",4),e.YNc(9,U,2,1,"div",7),e.qZA(),e.TgZ(10,"div",8),e.YNc(11,H,5,8,"div",9),e.qZA()()),2&i){const n=e.oxw();e.xp6(2),e.Akn(n.HeaderWidthStyle),e.xp6(6),e.Q6J("ngIf",n.ShowDaliyOnly),e.xp6(1),e.Q6J("ngForOf",n.WeekDaysToShow),e.xp6(2),e.Q6J("ngForOf",n.TimeslotNumbers)}}const L=[{path:"",component:(()=>{class i{constructor(n,t,o,a){this.apmt=n,this.dp=t,this.auth=o,this.router=a,this.NumberOfDaysToShow=7,this.ScheduledAppointments=[],this.WeekDays=[new h(!0),new h(!0),new h(!0),new h(!0),new h(!0),new h(!0),new h(!0)],this.TimeslotNumbers=Array.from({length:13},(l,r)=>r+1),this.WeekDaysToShow=this.WeekDays.slice(0,this.NumberOfDaysToShow),this.ViewerIsBusinessOwner=!1,this.NavigationHistory=[],this.CurrentWeekNavigationIndex=0,this.CurrentAppointmentIndex=0,this.AppointmentsLoaded=!1,this.DayViewIndex=0,this.NumFutureWeeksAhead=0,this.MaxFutureWeeksToShow=3,this.ShowDaliyOnly=!1,this.NavigateForwardtext="",this.NavigateBacktext="",this.CurrentWeekDates=[],this.StartOfWorkday=this.apmt.GetNewDateFromTime("07:00"),this.TimeslotWidthStyle="",this.HeaderWidthStyle="",this.HeadingWidthStyle="",this.TimeslotSeperatorStyle="",this.TimeSlotsMargin=""}ngOnInit(){this.routerSubscription=this.router.events.subscribe(n=>{n instanceof u.OD&&"/AppointmentsTimetable"!==n.url&&"/AppointmentInfo"!==n.url&&this.apmt.isRescheduling&&(this.apmt.isRescheduling=!1,console.log("Route is changing, variable set to false"))}),this.auth.loggedIn()?this.apmt.GetAppointmentsForBusiness().subscribe(n=>{this.ScheduledAppointments=n,this.LoadWeeklyTable(new Date,!0)}):this.apmt.GetAppointmentsForClients().subscribe(n=>{this.ScheduledAppointments=n,this.LoadWeeklyTable(new Date,!0)})}SwitchView(){this.UpdateView(!this.ShowDaliyOnly)}UpdateViewIndex(){this.apmt.OnUpdateViewIndex.next(this.DayViewIndex)}UpdateView(n){this.ShowDaliyOnly=n,this.NumberOfDaysToShow=this.ShowDaliyOnly?1:7,this.WeekDaysToShow=1===this.NumberOfDaysToShow?this.WeekDays.slice(0,this.NumberOfDaysToShow):this.WeekDays,this.TimeslotSeperatorStyle=1===this.NumberOfDaysToShow?"width:150px;":"width:305px;",this.HeadingWidthStyle=1===this.NumberOfDaysToShow?"width:300px;":"width:100%;",this.HeaderWidthStyle="width:150px;",this.TimeslotWidthStyle=1===this.NumberOfDaysToShow?"width:305px;":"width:1225px;",this.NavigateBacktext=this.ShowDaliyOnly?"Previous Day":"Previous Week",this.NavigateForwardtext=this.ShowDaliyOnly?"Next Day":"Next Week",this.UpdateViewIndex()}NavigateTable(n){var t=this;return g(function*(){n&&(t.ShowDaliyOnly?6===t.DayViewIndex?t.NumFutureWeeksAhead<t.MaxFutureWeeksToShow&&(yield t.LoadNextWeek(!0)):(t.DayViewIndex++,t.UpdateViewIndex()):t.NumFutureWeeksAhead<t.MaxFutureWeeksToShow&&(yield t.LoadNextWeek(!1))),n||(t.ShowDaliyOnly?t.DayViewIndex>0?(t.DayViewIndex--,t.UpdateViewIndex()):0===t.DayViewIndex&&t.CurrentWeekDates[0].toLocaleDateString()!==(new Date).toLocaleDateString()&&(yield t.LoadPrevWeek(!0)):t.NumFutureWeeksAhead>0&&(yield t.LoadPrevWeek(!1)))})()}LoadNextWeek(n){var t=this;return g(function*(){t.NumFutureWeeksAhead++,t.CurrentAppointmentIndex=t.NavigationHistory[t.CurrentWeekNavigationIndex].weekEndIndex,t.CurrentWeekNavigationIndex++;const o=t.CurrentWeekDates[t.CurrentWeekDates.length-1];yield t.LoadWeeklyTable(new Date(o.setDate(o.getDate()+1)),!0),t.ShowDaliyOnly&&(t.DayViewIndex=0),t.UpdateView(n)})()}LoadPrevWeek(n){var t=this;return g(function*(){t.NumFutureWeeksAhead--,t.CurrentWeekNavigationIndex--,t.CurrentAppointmentIndex=t.NavigationHistory[t.CurrentWeekNavigationIndex].weekStartIndex,t.NavigationHistory.splice(t.CurrentWeekNavigationIndex+1,1);const o=t.CurrentWeekDates[0];yield t.LoadWeeklyTable(new Date(o.setDate(o.getDate()-7)),!1),t.ShowDaliyOnly&&(t.DayViewIndex=6),t.UpdateView(n)})()}SetTimeTable(n){var t=this;return g(function*(){let o=0,a=t.CurrentAppointmentIndex;const l=new Date(t.ScheduledAppointments[0].AppointmentDate);for(let r=0;r<t.CurrentWeekDates.length&&l.getTime()>t.CurrentWeekDates[r].getTime();r++)yield t.AddBlankTimeSlot(780,"08:00","21:00",r),o++;for(let r=o;r<t.CurrentWeekDates.length;r++){const c=t.CurrentWeekDates[r].toLocaleDateString();let d=t.apmt.GetNewDateFromTime("08:00"),v=!1;for(;a<t.ScheduledAppointments.length&&t.ScheduledAppointments[a].AppointmentDate===c;){v=!0;const f=t.ScheduledAppointments[a],T=t.apmt.GetNewDateFromTime(f.AppointmentTime);let b=f.AppointmentDurationInMinutes;if(T.getTime()>d.getTime()){const B=(T.getTime()-d.getTime())/6e4;yield t.AddBlankTimeSlot(B,t.dp.transform(d,"HH:mm"),f.AppointmentTime,r)}const y=new Date(T.getTime());y.setMinutes(T.getMinutes()+b),t.WeekDays[r].TimeSlots.push(new A.o(f.AppointmentTime,y.toLocaleTimeString(),r,t.dp.transform(t.CurrentWeekDates[r],"M/d/yyyy"),f,b/60)),d=y,a++}(!v||t.apmt.GetNewDateFromTime("21:00").getTime()-d.getTime()>0)&&(yield t.AddBlankTimeSlot((t.apmt.GetNewDateFromTime("21:00").getTime()-d.getTime())/6e4,d.toLocaleTimeString(),"21:00",r))}if(n){const r=new C(t.CurrentAppointmentIndex,a);t.NavigationHistory.push(r)}})()}AddBlankTimeSlot(n,t,o,a){var l=this;return g(function*(){const r=new A.o(t,o,a,l.dp.transform(l.CurrentWeekDates[a],"M/d/yyyy"),null,n/60);l.WeekDays[a].TimeSlots.push(r)})()}LoadWeeklyTable(n,t){var o=this;return g(function*(){o.CurrentWeekDates=[],o.WeekDays.forEach(a=>{a.TimeSlots=[],a.isEmpty=!0});for(let a=0;a<7;a++){const l=new Date(n);l.setDate(l.getDate()+a),o.CurrentWeekDates.push(l)}o.UpdateView(!0),yield o.SetTimeTable(t),o.AppointmentsLoaded=!0})()}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(k.H),e.Y36(m.uU),e.Y36(_.e),e.Y36(u.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-appointments-timetable"]],decls:14,vars:7,consts:[[1,"Whole-Table"],[1,"Timetable-Settings"],[3,"click"],[1,"Timetable-Nav"],[4,"ngIf"],[1,"Table-Content"],[1,"Weekdays"],["class","TimeTable-Day",4,"ngFor","ngForOf"],[1,"TimeTable-Times"],["class","Timeslot-Hour",3,"style",4,"ngFor","ngForOf"],[1,"TimeTable-Day"],[3,"WeekDays","CurrentWeekIndex","isDailyViewMode"],[1,"Timeslot-Hour"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"BookingsTimetable"),e.qZA(),e.TgZ(3,"div",1)(4,"a",2),e.NdJ("click",function(){return t.NavigateTable(!1)}),e.TgZ(5,"div",3),e._uU(6),e.qZA()(),e.TgZ(7,"a",2),e.NdJ("click",function(){return t.NavigateTable(!0)}),e.TgZ(8,"div",3),e._uU(9),e.qZA()(),e.TgZ(10,"a",2),e.NdJ("click",function(){return t.SwitchView()}),e.TgZ(11,"div",3),e._uU(12,"Switch View"),e.qZA()()(),e.YNc(13,P,12,5,"div",4),e.qZA()),2&n&&(e.xp6(1),e.Akn(t.HeadingWidthStyle),e.xp6(2),e.Akn(t.HeadingWidthStyle),e.xp6(3),e.Oqu(t.NavigateBacktext),e.xp6(3),e.Oqu(t.NavigateForwardtext),e.xp6(4),e.Q6J("ngIf",t.AppointmentsLoaded))},dependencies:[m.sg,m.O5,D,m.uU],styles:[".Table-Content[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(9,1fr);width:-moz-fit-content;width:fit-content;z-index:2;position:absolute}body[_ngcontent-%COMP%]{margin:0;padding:0;overflow:auto}.Whole-Table[_ngcontent-%COMP%]{width:1200px;padding:20px;position:relative;height:auto;align-items:center;justify-content:center}.Whole-Table[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:700;text-align:center;background-color:#9dc2b7;justify-content:center;border-style:none;border-radius:5px}.Timeslot-Hour[_ngcontent-%COMP%]{border:2.5px solid #3f3e3e;height:50px;display:flex;align-items:center}.Timeslot-Hour[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border-right:2px solid black;height:100%}.TimeTable-Times[_ngcontent-%COMP%]{z-index:1;display:flex;flex-direction:column;position:absolute;margin-top:50px}.Timetable-Settings[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px;position:relative;background-color:#9dc2b7;align-items:center;justify-content:center;border-style:none;border-radius:5px}.Timetable-Nav[_ngcontent-%COMP%]{padding:.25vw;font-weight:700;color:#000;border-style:none;border-radius:5px}.Timetable-Nav[_ngcontent-%COMP%]:Hover{background-color:#004e8d;color:#fff}a[_ngcontent-%COMP%]{text-decoration:none;cursor:pointer}span[_ngcontent-%COMP%]{font-weight:700;font-size:clamp(1.2rem,5vw + 1rem)}.Weekdays[_ngcontent-%COMP%]{height:50px;text-align:center;align-items:center;font-weight:700;font-size:clamp(1.3rem,5vw + 1rem);color:#fff;background-color:#5a8f7f;border:2px solid black;justify-content:center;width:-moz-fit-content;width:fit-content}"]}),i})()}];let q=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.Bz.forChild(L),u.Bz]}),i})(),J=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.ez,q,u.Bz,D]}),i})()}}]);