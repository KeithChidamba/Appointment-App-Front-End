"use strict";(self.webpackChunkAppointent_App=self.webpackChunkAppointent_App||[]).push([[413],{9413:(M,d,o)=>{o.r(d),o.d(d,{AppointmentInfoModule:()=>C});var a=o(6895),s=o(2019),u=o(7818),c=o(5973),p=o(433),g=o(7579),t=o(8256),h=o(2646),f=o(1265);function A(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(n);const m=t.oxw();return t.KtG(m.ReScheduleAppointment())}),t._uU(1,"Re-schedule"),t.qZA()}}function T(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"div",6)(1,"p",7),t._uU(2,"You can edit the following fields:"),t.qZA(),t.TgZ(3,"form",8)(4,"div",9)(5,"label",10),t._uU(6,"Appointment Time"),t.qZA(),t._UZ(7,"input",11),t.TgZ(8,"div",12)(9,"button",13),t._uU(10,"Cancel"),t.qZA(),t.TgZ(11,"button",14),t.NdJ("click",function(){t.CHM(n);const m=t.oxw();return t.KtG(m.ValidateAppointmentTime())}),t._uU(12,"Save"),t.qZA()()()()()}if(2&e){const n=t.oxw();t.xp6(3),t.Q6J("formGroup",n.Editingform)}}const b=[{path:"",component:(()=>{class e{constructor(n,i,m,l){this.fb=n,this.apmnt=i,this.dp=m,this.router=l,this.TimeslotForEditing=new u.o("","",0,"",null,0),this.AppointmentInfo=new c.u(0,"","","","","","","",0,"",0,0,0),this.LatestBookingTime="21:00",this.ValidAppointment=!1,this.ValidatingTime=!1,this.OnNewError=new g.x,this.EarliestDate=this.dp.transform(new Date,"yyyy-MM-dd"),this.Editingform=this.fb.group({AppointmentTime:["",p.kI.required]})}ngOnInit(){this.ValidatingTime=this.apmnt.isRescheduling,this.apmnt.isRescheduling=!1,this.TimeslotForEditing=this.apmnt.GetCurrentSlot(),this.AppointmentInfo=this.TimeslotForEditing.CurrentAppointment,this.routerSubscription=this.router.events.subscribe(n=>{n instanceof s.OD&&"/AppointmentsTimetable"!==n.url&&"/AppointmentInfo"!==n.url&&(this.apmnt.isRescheduling=!1)})}ReScheduleAppointment(){this.apmnt.isRescheduling=!0,this.apmnt.AppointmentToReSchedule=this.AppointmentInfo,this.router.navigate(["/AppointmentsTimetable"])}ValidateAppointmentTime(){var n=Math.abs(this.apmnt.GetNewDateFromTime(this.TimeslotForEditing.EndTime).getTime()-this.apmnt.GetNewDateFromTime(this.TimeslotForEditing.StartTime).getTime())/6e4;this.AppointmentInfo.AppointmentDurationInMinutes>n?(this.OnNewError.next("The selected appointment type is too long for this time slot"),this.ValidAppointment=!1):this.AppointmentInfo.AppointmentDurationInMinutes<n?(this.LatestBookingTime=this.dp.transform(this.apmnt.GetNewDateFromTime(this.TimeslotForEditing.EndTime).setMinutes(-this.AppointmentInfo.AppointmentDurationInMinutes),"HH:mm"),this.ValidAppointment=!0):this.AppointmentInfo.AppointmentDurationInMinutes==n&&(this.LatestBookingTime=this.TimeslotForEditing.StartTime,this.ValidAppointment=!0);var i=this.dp.transform(this.apmnt.GetNewDateFromTime(this.Editingform.get("AppointmentTime")?.value),"HH:mm"),m=this.apmnt.GetNewDateFromTime(i);if(this.apmnt.GetNewDateFromTime(this.LatestBookingTime).getTime()<m.getTime())this.OnNewError.next("The selected appointment time later than the selected time slot");else if(m.getTime()<this.apmnt.GetNewDateFromTime(this.TimeslotForEditing.StartTime).getTime())this.OnNewError.next("The selected appointment time earlier than the selected time slot");else if((this.apmnt.GetNewDateFromTime(this.LatestBookingTime).getTime()-m.getTime())/6e4>=this.AppointmentInfo.AppointmentDurationInMinutes)this.AppointmentInfo.AppointmentTime=i,this.ValidAppointment&&this.SaveChanges();else{this.ValidAppointment=!1;let l=Math.abs((m.getTime()-this.apmnt.GetNewDateFromTime(this.TimeslotForEditing.EndTime).getTime())/6e4);this.OnNewError.next(`The selected appointment time must be ${l} minutes earlier`)}}SaveChanges(){this.ValidAppointment&&(this.apmnt.UpdateAppointment(this.AppointmentInfo).subscribe(n=>{console.log(n)},n=>{this.OnNewError.next(n)}),this.apmnt.isRescheduling=!1,this.apmnt.OnAppointmentSelected.next(!1))}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(p.qu),t.Y36(h.H),t.Y36(a.uU),t.Y36(s.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-appointment-info"]],decls:19,vars:9,consts:[[3,"OnNewError"],[1,"appointment-container"],[1,"appointment-details"],["class","toggle-edit-btn",3,"click",4,"ngIf"],["class","edit-form-container",4,"ngIf"],[1,"toggle-edit-btn",3,"click"],[1,"edit-form-container"],[1,"form-instruction"],[1,"edit-form",3,"formGroup"],[1,"form-group"],["for","appointmentTime"],["type","time","id","appointmentTime","name","time","formControlName","AppointmentTime",1,"input-field"],[1,"form-buttons"],["type","button","routerLink","/AppointmentsTimetable",1,"cancel-btn"],[1,"save-btn",3,"click"]],template:function(n,i){1&n&&(t._UZ(0,"app-error-display",0),t.TgZ(1,"div",1)(2,"h1"),t._uU(3),t.qZA(),t.TgZ(4,"div",2)(5,"p")(6,"strong"),t._uU(7,"Duration:"),t.qZA(),t._uU(8),t.qZA(),t.TgZ(9,"p")(10,"strong"),t._uU(11,"Time:"),t.qZA(),t._uU(12),t.qZA(),t.TgZ(13,"p")(14,"strong"),t._uU(15,"Date:"),t.qZA(),t._uU(16),t.qZA()()(),t.YNc(17,A,2,0,"button",3),t.YNc(18,T,13,1,"div",4)),2&n&&(t.Q6J("OnNewError",i.OnNewError),t.xp6(3),t.lnq("",i.AppointmentInfo.AppointmentName," Appointment for ",i.AppointmentInfo.ClientFirstName," ",i.AppointmentInfo.ClientLastName,""),t.xp6(5),t.hij(" ",i.AppointmentInfo.AppointmentDurationInMinutes," minutes"),t.xp6(4),t.hij(" ",i.AppointmentInfo.AppointmentTime,""),t.xp6(4),t.hij(" ",i.AppointmentInfo.AppointmentDate,""),t.xp6(1),t.Q6J("ngIf",!i.ValidatingTime),t.xp6(1),t.Q6J("ngIf",i.ValidatingTime))},dependencies:[a.O5,s.rH,p._Y,p.Fj,p.JJ,p.JL,p.sg,p.u,f.n],styles:[".appointment-container[_ngcontent-%COMP%]{padding:1rem;border-radius:8px;background-color:#f5f5f5;margin-bottom:1rem}.appointment-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:1rem}.appointment-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.3rem 0;font-size:1rem}.toggle-edit-btn[_ngcontent-%COMP%]{margin:1rem 0;padding:.6rem 1.2rem;background-color:#007bff;color:#fff;border:none;border-radius:6px;font-size:1rem;cursor:pointer}.edit-form-container[_ngcontent-%COMP%]{padding:1rem;background-color:#fff;border:1px solid #ddd;border-radius:8px}.form-instruction[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:1rem}.edit-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.input-field[_ngcontent-%COMP%]{padding:.5rem;font-size:1rem;border:1px solid #ccc;border-radius:6px}.form-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:1.5rem}.cancel-btn[_ngcontent-%COMP%], .save-btn[_ngcontent-%COMP%]{padding:.6rem 1.2rem;font-size:1rem;border:none;border-radius:6px;cursor:pointer}.cancel-btn[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.save-btn[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}@media (max-width: 600px){.form-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.cancel-btn[_ngcontent-%COMP%], .save-btn[_ngcontent-%COMP%], .toggle-edit-btn[_ngcontent-%COMP%]{width:100%}}"]}),e})()}];let I=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[s.Bz.forChild(b),s.Bz]}),e})(),C=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[a.ez,I,p.UX,f.n]}),e})()}}]);